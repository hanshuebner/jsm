// Load the C++ extension, extend it by some convenience functions

var MIDI = require('../build/default/MIDI.node');

for (var i in MIDI) {
    exports[i] = MIDI[i];
}

MIDI.MIDIOutput.prototype.sendNote = function (note, velocity, time) {
    this.send('9' + (this.channel || 0).toString(16) + ' ' + note.toString(16) + ' ' + (velocity || 0).toString(16),
             time);
}

MIDI.MIDIInput.prototype.recvText = function(callback) {
    this.recv(function (data) {
        var stringData = [];
        for (var i in data) {
            var asNumbers = data[i];
            var asString = '';
            for (var j = 0; j < asNumbers.length; j++) {
                if (j > 0) {
                    asString += ' ';
                }
                asString += asNumbers[j].toString(16);
            }
            stringData.push(asString);
        }
        callback(stringData);
    });
}